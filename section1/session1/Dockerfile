FROM node:14

WORKDIR /app
 
COPY package.json .

RUN npm install

COPY . .

EXPOSE 3000

CMD [ "node", "app.mjs" ]

# 위와 같은 설정을 한 후
# 터미널에서 docker build . 해서 이미지를 빌드함

# 이후 docker run -p 3000:3000 [이미지 ID] 로 실행 (로컬포트):(EXPOSE 포트)
# -> 로컬시스템의 로컬호스트를 사용하여 컨테이너 대신 포트 3000에서 실행되는 애플리케이션에 연결함 
# -> 컨테이너와 호스트 운영 체제 사이에는 디폴트 연결이 없기 때문
# 예를들어 컨테이너에서 실행 중인 애플리케이션에 http 요청을 보내려면 통신하려는 컨테이너의 포트를 열어야 합니다.
# 그렇지 않으면 컨테이너에 잠긴 네트워크이므로 외부에서 연결할 수 없습니다.

# 이후 터미널이 멈추면(컨테이너가 실행된거임)
# localhost:(로컬포트) 를 주소창에 치면 접속 가능
# 이로써 우리는 NodeJS과 npm install과 같은 작업 없이 서버를 열었습니다.

# docker ps 실행 (현재 실행중인 모든 컨테이너 나열)
# 거기에서 나오는 임의로 지정된 컨테이너 이름을 가지고 
# docker stop [컨테이너 NAMES] 으로 컨테이너 멈춤